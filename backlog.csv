ID,Title,Type,Priority,Effort,Owner,Status,Area,Description,AcceptanceCriteria,Dependencies
BL-001,Secure AppSettings endpoints,Task,P0,S,TBD,Done,Api,"Require JWT + Admin role for AppSettingsController; stop binding Domain entity directly (use DTOs).","Unauthenticated requests return 401; non-admin returns 403; CRUD uses DTOs; Swagger bearer works.","BL-002"
BL-002,Add Admin role baseline,Task,P0,M,TBD,Done,Api/Infrastructure,"Create Admin role wiring for future admin endpoints (authorization via [Authorize(Roles=\"Admin\")]).","Admin role can be enforced on controllers/actions; dev seeding can create Admin role/user.",""
BL-003,Standardize API error handling (ProblemDetails),Task,P0,M,TBD,Done,Api,"Add global exception handler + consistent ProblemDetails responses; unify 400/401/403/404 patterns.","Errors return RFC7807 with stable shape; no raw exception messages in production.",""
BL-004,Unify question/deck data source,Task,P0,L,TBD,Done,Architecture,"Currently there is SQL-backed study/decks and an embedded JSON question bank for /api/questions. Pick one source-of-truth (recommend SQL) and refactor endpoints accordingly.","Decks/questions/study endpoints use one consistent source; IDs match across endpoints and UI.","BL-003"
BL-005,Fix userId claim extraction consistency,Task,P0,S,TBD,Todo,Api,"Standardize JWT claim mapping for user id so all controllers parse user id the same way.","All authorized endpoints derive userId reliably; no Unauthorized caused by missing claim mapping.","BL-003"
BL-006,Add request validation for public endpoints,Task,P1,M,TBD,Todo,Api,"Validate Register/Login/Settings/Study payloads (e.g. required fields, bounds) and return validation ProblemDetails.","Invalid payload returns 400 with field-level errors.","BL-003"
BL-007,Improve UI error display,Task,P1,M,TBD,Todo,Ui.Blazor,"Parse ProblemDetails and show user-friendly error messages; avoid surfacing raw EnsureSuccessStatusCode exceptions.","Login/Register/Settings/Study show consistent, readable errors.","BL-003"
BL-008,Add onboarding route guard,Task,P1,M,TBD,Todo,Ui.Blazor,"Redirect authenticated users with IsOnboarded=false to /onboarding from all other pages.","User cannot access study/settings before onboarding.",""
BL-009,Align onboarding with UserSettings domain,Task,P1,L,TBD,Todo,Api/Ui.Blazor,"Extend onboarding to set FontScale/AudioSpeed/StudyFocus/SilentMode and persist to DB.","Onboarding collects and saves settings; UI uses stored preferences.","BL-006"
BL-010,Remove dev DB connection printing,Task,P1,XS,TBD,Todo,Infrastructure,"Replace Console.WriteLine of SQL connection target/user with ILogger and redact secrets; ensure non-dev prints nothing.","No connection user/password printed to console; logs are structured.",""
BL-011,Fix nullability warning in StudyController,Task,P2,XS,TBD,Done,Api,"Normalize null strings when mapping DB question -> Shared contracts to remove CS8604 warning.","Solution builds with 0 warnings.",""
BL-012,Add docker-compose for SQL Server,Task,P2,S,TBD,Todo,DevEx,"Add docker-compose.yml for local SQL Server and document in local config.","One command starts DB; docs updated.",""
BL-013,Add readiness/health endpoint,Task,P2,S,TBD,Todo,Api,"Add health/readiness endpoint including DB connectivity check.","/health returns unhealthy when DB down.",""
BL-014,Request logging + correlation id,Task,P2,M,TBD,Todo,Observability,"Add middleware for request logging; include correlation id header + logging scope.","Logs include correlation id, route, status, latency.",""
BL-015,Rate limit auth endpoints,Task,P2,M,TBD,Todo,Security,"Apply basic rate limiting to login/register endpoints.","Repeated login attempts are throttled; legitimate use still works.",""
BL-016,CORS production configuration,Task,P2,S,TBD,Todo,Api,"Document and enforce Cors:AllowedOrigins for non-development.","Non-dev rejects unknown origins; docs show how to configure.",""
BL-017,Refactor controllers to use Application services,Task,P2,M,TBD,InProgress,Architecture,"Reduce direct EF usage in controllers by introducing Application interfaces for study/decks queries.","Controllers become thin; data access centralized.","BL-004"
BL-018,Optimize next-question selection,Task,P2,M,TBD,Todo,Api,"Avoid COUNT+Skip approach for large tables; implement more scalable selection strategy.","Next question remains performant with large deck sizes.","BL-017"
BL-019,Add paging for deck questions list,Task,P2,S,TBD,Todo,Api,"Expose paged list endpoint for questions by deck.","Endpoint supports page/pageSize and returns stable ordering.","BL-004"
BL-020,WorkerService meaningful job skeleton,Task,P2,M,TBD,Todo,WorkerService,"Replace heartbeat loop with a real job skeleton (config, DI scope, error handling).","Worker runs with scoped services; errors are logged; graceful shutdown works.","BL-003"
BL-021,Unit tests: JwtTokenService,Test,P1,S,TBD,Todo,Testing,"Add unit tests for JWT token creation (claims, expiry).","Tests validate required claims and expiry window.",""
BL-022,Integration tests: auth flow,Test,P1,M,TBD,Todo,Testing,"Integration tests for register/login + authorized endpoint.","Tests pass against test SQL Server.","BL-012"
BL-023,Integration tests: study flow,Test,P2,M,TBD,Done,Testing,"Integration tests for decks->next->answer->today.","Tests pass end-to-end (in-memory test host).",""
BL-024,Add CI pipeline (build + test),Chore,P1,M,TBD,Done,CI,"Add CI (GitHub Actions/Azure DevOps) for restore/build/test.","PR checks run and block merges on failure.","BL-021;BL-022"
BL-025,Add formatting/analyzers enforcement in CI,Chore,P2,S,TBD,Todo,CI,"Enforce dotnet format/analyzers in CI.","CI fails on formatting or analyzer violations.","BL-024"
